C51 COMPILER V8.08   TASK                                                                  05/28/2015 23:26:59 PAGE 1   


C51 COMPILER V8.08, COMPILATION OF MODULE TASK
OBJECT MODULE PLACED IN task.OBJ
COMPILER INVOKED BY: D:\Program Files\keil-3\C51\BIN\C51.EXE task.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /*************************************************************
   2                               Ê±ÖÓÏÔÊ¾³ÌÐò
   3          ³ÌÐò±àÐ´£ºFucp   2015-5-16
   4          DIYÌ×¼þ  http://59tiaoba.taobao.com
   5          
   6          µ¥Æ¬»ú IAP15W4K61S4  »òÕßÆäËû51  ¾§ÕñÆµÂÊ 18.432M  
   7          ×ÖÄ£Èí¼þÓÃ  PC2002
   8          ÖðÁÐÈ¡Ä£·½Ê½
   9          
  10          µç»úÐý×ª·½Ïò Ë³Ê±Õë
  11          /***********************************************************
  12          ËµÃ÷£º±¾³ÌÐòÖ§³ÖÅäÌ×Ò£¿ØÆ÷µ÷ÕûÊ±¼ä
  13          ²¥·Å°´¼ü  ÇÐ»»µ÷Õû Ê±¡¢·Ö¡¢Ãë¡¢ÔÂ¡¢ÈÕ
  14          ¼Ó °´¼ü£ºÔö¼Ó
  15          ¼õ °´¼ü£º¼õÉÙ
  16          menu°´¼ü£º Ê±ÖÓ¸´Î»
  17          
  18          Æ½ÃæÏÔÊ¾ÎÄ×Ö+²àÃæÏÔÊ¾Ê±ÖÓ
  19          
  20          *************************************************************/
  21          #include "NEW_8051.H"
  22          #include "intrins.h"
  23          #include "task.h"
  24          bit Scan_bit=0;
  25          bit BIT_timeout=0;
  26          
  27          
  28          
  29          /*********ÖÐ¶Ï×Ó³ÌÐò**********/
  30          void int0() interrupt 0 //Ê¹ÓÃÍâ²¿ÖÐ¶Ï0
  31          {
  32   1              BIT_timeout=1; //Æðµã±êÖ¾Î»     
  33   1      }
  34          /******************************************/
  35          void Send_uart(unsigned char d)   /*´Ó´®¿Ú·¢ËÍÊý¾Ý*/
  36          {
  37   1                ES=0;
  38   1            SBUF=d;
  39   1                while(TI==0);       //µÈ´ý·¢ËÍÍê±Ï
  40   1            TI=0;
  41   1                ES=1;
  42   1      }
  43          /*********************************************/
  44          void Init(void)
  45          {
  46   1              P0M0=0X00;//³õÊ¼»¯IO¿Ú Îª×¼Ë«Ïò¿Ú
  47   1              P0M1=0X00;
  48   1      
  49   1              P1M0=0X00;
  50   1              P1M1=0X00;
  51   1      
  52   1              P2M0=0X00;
  53   1              P2M1=0X00;
  54   1      
  55   1              P3M0=0X00;
C51 COMPILER V8.08   TASK                                                                  05/28/2015 23:26:59 PAGE 2   

  56   1              P3M1=0X00;
  57   1      
  58   1              P4M0=0X00;
  59   1              P4M1=0X00;
  60   1      
  61   1              P5M0=0X00;
  62   1              P5M1=0X00;
  63   1      
  64   1              P6M0=0X00;
  65   1              P6M1=0X00;
  66   1      
  67   1              P7M0=0X00;
  68   1              P7M1=0X00;
  69   1      
  70   1              Show_R(0x55,0x55);//²âÊÔ
  71   1              Show_L(0x55,0x55,0x55,0x55);//²âÊÔ
  72   1              AUXR &= 0x7F;           //¶¨Ê±Æ÷Ê±ÖÓ12TÄ£Ê½
  73   1              TMOD &= 0xF0;           //ÉèÖÃ¶¨Ê±Æ÷Ä£Ê½
  74   1              TL0 = 0x12;             //ÉèÖÃ¶¨Ê±³õÖµ
  75   1              TH0 = 0xFF;             //ÉèÖÃ¶¨Ê±³õÖµ
  76   1              TF0 = 0;                //Çå³ýTF0±êÖ¾
  77   1              ET0=1;
  78   1              //TR0 = 1;              //¶¨Ê±Æ÷0¿ªÊ¼¼ÆÊ±
  79   1      
  80   1              SCON = 0x50;            //8Î»Êý¾Ý,¿É±ä²¨ÌØÂÊ
  81   1              AUXR &= 0xBF;           //¶¨Ê±Æ÷1Ê±ÖÓÎªFosc/12,¼´12T
  82   1              AUXR &= 0xFE;           //´®¿Ú1Ñ¡Ôñ¶¨Ê±Æ÷1Îª²¨ÌØÂÊ·¢ÉúÆ÷
  83   1              TMOD &= 0x0F;           //Éè¶¨¶¨Ê±Æ÷1Îª16Î»×Ô¶¯ÖØ×°·½Ê½
  84   1              TL1 = 0xD8;             //Éè¶¨¶¨Ê±³õÖµ
  85   1              TH1 = 0xFF;             //Éè¶¨¶¨Ê±³õÖµ
  86   1              ET1 = 0;                //½ûÖ¹¶¨Ê±Æ÷1ÖÐ¶Ï
  87   1              TR1 = 1;                //Æô¶¯¶¨Ê±Æ÷1
  88   1      
  89   1           IT0 = 1;    //Íâ²¿ÖÐ¶ÏÎª±ßÑØ´¥·¢
  90   1                         //ÉèÖÃINT0µÄÖÐ¶ÏÀàÐÍ (1:½öÏÂ½µÑØ 0:ÉÏÉýÑØºÍÏÂ½µÑØ)
  91   1           EX0 = 1;  //Ê¹ÄÜINT0ÖÐ¶Ï
  92   1      
  93   1               IT1=1;
  94   1               EX1=1;//Íâ²¿ÖÐ¶Ï1 ÏÂ½µÑØ ÖÐ¶Ï
  95   1               EA = 1;                 
  96   1      }
  97          /*****Ö÷º¯Êý*****/
  98          void main(void)
  99          {
 100   1              Init();
 101   1              Auto_Set1302(starts_time);//×Ô¶¯³õÊ¼»¯Ê±ÖÓ
 102   1              Send_uart(0x55);
 103   1              
 104   1          //Ö÷³ÌÐò
 105   1              while(1)
 106   1          {           
 107   2               //BIT_timeout=1;
 108   2                      if(BIT_timeout==1)      //ÆðµãÅÐ¶Ï
 109   2                      {                       
 110   3                              BIT_timeout=0; //ÇåÁã
 111   3                              
 112   3                              Scan_bit=1;// Æðµã¼ì²âµ½ºó LED²»ÔÙÁ÷Ë®²âÊÔ
 113   3                              if( new_code ) //ÓÐºìÍâ°´¼ü
 114   3                              {
 115   4                                      new_code=0;
 116   4                                      switch( key_code ) //¸ù¾Ý²»Í¬µÄ°´¼üÖµÖ´ÐÐ²»Í¬µÄ¶¯×÷
 117   4                                      {       
C51 COMPILER V8.08   TASK                                                                  05/28/2015 23:26:59 PAGE 3   

 118   5                                      
 119   5                                              case 0x40:       //µ÷Ê±¼Ó
 120   5                                                      Set(id,1);
 121   5      
 122   5                                              break;
 123   5              
 124   5                                              case 0x19: //µ÷Ê±¼õ                             
 125   5                                                              Set(id,0); 
 126   5                                              
 127   5                                              break;
 128   5                                              
 129   5                                              case 0x15://µ÷Ê±ÇÐ»»
 130   5                                                                      id++;                                           
 131   5                                                                      if(id>5)
 132   5                                                                      {
 133   6                                                                      id=0;
 134   6                                                                      }
 135   5                                              break;
 136   5                                              case 0x47://Ê±ÖÓ³õÊ¼»¯
 137   5                                                              Set1302(starts_time);    //³õÊ¼»¯ 
 138   5                                                              W1302(0x8e,0x00); //¿ØÖÆÃüÁî,WP=0,Ð´²Ù×÷                
 139   5                                                              W1302(0x90,0xa5); //´òª³äµ¶þ¼¶Ü  Ò»¸ö¶þ¼¶¹Ü´®ÁªÒ»¸ö2Kçè
 140   5                                                              //write_1302Data(DISP_TIME_adder,160);
 141   5                                              break;
 142   5              
 143   5                                              default: break;
 144   5                                      }
 145   4                                      key_code=0;
 146   4                              }
 147   3                              du1302();//¶ÁÈ¡Ê±ÖÓÐ¾Æ¬ µÄÊ±ÖÓÊý¾Ý
 148   3                              Show_line_time();//ÏÔÊ¾Ê±¼ä
 149   3          
 150   3                  
 151   3                      }   
 152   2          
 153   2                      }
 154   1      }
 155          /*********************************************************************************/
 156          /*************************************************************************************
 157          ************************************************************************************
 158          ***********************                                     ***************************
 159          ***********************    http://59tiaoba.taobao.com       ***************************
 160          ***********************                                     ***************************
 161          ************************************************************************************
 162          **********************************************************************************/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    224    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      2    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
